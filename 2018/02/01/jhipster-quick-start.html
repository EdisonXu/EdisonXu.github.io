<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><title>JHipster快速开发Web应用 | SpringBoot | JHipster | 微服务 | Edison Xu&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="在基于Spring的Web项目开发中，通常存在两个问题：  普通CRUD的代码基本重复，完全是体力活； Controller层和持久层之间的数据传递，存在不规范。有人喜欢直接返回JSON，有人喜欢用DTO，有人喜欢直接Entity。   那如何解决这个问题呢？自动生成呗。一群喜欢动脑筋（懒）的人，发明了JHipster。  JHipster是一个基于SpringBoot和Angular的快速We"><meta name="keywords" content="SpringBoot,JHipster,微服务"><meta property="og:type" content="article"><meta property="og:title" content="JHipster快速开发Web应用"><meta property="og:url" content="http://edisonxu.org/2018/02/01/jhipster-quick-start.html"><meta property="og:site_name" content="Edison Xu&#39;s Blog"><meta property="og:description" content="在基于Spring的Web项目开发中，通常存在两个问题：  普通CRUD的代码基本重复，完全是体力活； Controller层和持久层之间的数据传递，存在不规范。有人喜欢直接返回JSON，有人喜欢用DTO，有人喜欢直接Entity。   那如何解决这个问题呢？自动生成呗。一群喜欢动脑筋（懒）的人，发明了JHipster。  JHipster是一个基于SpringBoot和Angular的快速We"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://edisonxu.org/images/2018/02/logo-jhipster.svg"><meta property="og:updated_time" content="2018-02-23T02:19:15.417Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JHipster快速开发Web应用"><meta name="twitter:description" content="在基于Spring的Web项目开发中，通常存在两个问题：  普通CRUD的代码基本重复，完全是体力活； Controller层和持久层之间的数据传递，存在不规范。有人喜欢直接返回JSON，有人喜欢用DTO，有人喜欢直接Entity。   那如何解决这个问题呢？自动生成呗。一群喜欢动脑筋（懒）的人，发明了JHipster。  JHipster是一个基于SpringBoot和Angular的快速We"><meta name="twitter:image" content="http://edisonxu.org/images/2018/02/logo-jhipster.svg"><link rel="alternate" href="/atom.xml" title="Edison Xu&#39;s Blog" type="application/atom+xml"><link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/vendor/open-sans/styles.css"><link rel="stylesheet" href="/vendor/source-code-pro/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/vendor/jquery/2.1.3/jquery.min.js"></script><link rel="stylesheet" href="/vendor/lightgallery/css/lightgallery.min.css"></head><body><div id="container"><header id="header"><div id="header-main" class="header-inner"><div class="outer"><a href="/" id="logo"><i class="logo"></i> <span class="site-title">Edison Xu&#39;s Blog</span></a><nav id="main-nav"> <a class="main-nav-link" href="/.">主页</a> <a class="main-nav-link" href="/archives">目录</a> <a class="main-nav-link" href="http://blog.csdn.net/xeseo">旧站</a> <a class="main-nav-link" href="/about">关于我</a></nav><nav id="sub-nav"><div class="profile" id="profile-nav"> <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://www.gravatar.com/avatar/e8022ebe2f6f01924ccded8d4db8b9fa"><i class="fa fa-caret-down"></i></a></div></nav><div id="search-form-wrap"><form class="search-form"> <input type="text" class="ins-search-input search-form-input" placeholder="搜索"> <button type="submit" class="search-form-submit"></button></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"> <input type="text" class="ins-search-input" placeholder="想要查找什么..."><span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script></div></div></div><div id="main-nav-mobile" class="header-sub header-inner"><table class="menu outer"><tr><td><a class="main-nav-link" href="/.">主页</a></td><td><a class="main-nav-link" href="/archives">目录</a></td><td><a class="main-nav-link" href="http://blog.csdn.net/xeseo">旧站</a></td><td><a class="main-nav-link" href="/about">关于我</a></td><td><div class="search-form"> <input type="text" class="ins-search-input search-form-input" placeholder="搜索"></div></td></tr></table></div></header><div class="outer"><aside id="profile"><div class="inner profile-inner"><div class="base-info profile-block"> <img id="avatar" src="https://www.gravatar.com/avatar/e8022ebe2f6f01924ccded8d4db8b9fa?s=128"><h2 id="name">Edison Xu</h2><h3 id="title">懂得前端和移动，设计过架构，做过管理，也搞过自动化和运维，明白各种测试，知晓处理大数据。保持危机感和谦逊，方能更进一步</h3><span id="location"><i class="fa fa-map-marker"></i> 中国 - 上海</span> <a id="follow" target="_blank" href="http://edisonxu.com/about">关注我</a></div><div class="article-info profile-block"><div class="article-info-block"> 16 <span>文章</span></div><div class="article-info-block"> 16 <span>标签</span></div></div><div class="profile-block social-links"><table><tr><td><a href="https://github.com/EdisonXu" target="_blank" title="github" class="tooltip"><i class="fa fa-github"></i></a></td><td><a href="mailto:edisonxu@outlook.com" target="_blank" title="envelope" class="tooltip"><i class="fa fa-envelope"></i></a></td><td><a href="/css/images/myweixin.jpg" target="_blank" title="weixin" class="tooltip"><i class="fa fa-weixin"></i></a></td><td><a href="/atom.xml" target="_blank" title="rss" class="tooltip"><i class="fa fa-rss"></i></a></td></tr></table></div></div></aside><section id="main"><article id="post-jhipster-quick-start" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name"> JHipster快速开发Web应用</h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/2018/02/01/jhipster-quick-start.html"><time datetime="2018-02-01T08:39:24.000Z" itemprop="datePublished">2018-02-01</time></a></div><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/JHipster/">JHipster</a>, <a class="tag-link" href="/tags/SpringBoot/">SpringBoot</a>, <a class="tag-link" href="/tags/微服务/">微服务</a><span id="busuanzi_container_site_pv" style="display:none;float:right"><i class="fa fa-eye" aria-hidden="true" style="margin-right:5px"></i><span id="busuanzi_value_page_pv"></span> 人阅读</span></div></header><div class="article-entry" itemprop="articleBody"><blockquote><p>在基于Spring的Web项目开发中，通常存在两个问题：</p><ol><li>普通CRUD的代码基本重复，完全是体力活；</li><li>Controller层和持久层之间的数据传递，存在不规范。有人喜欢直接返回JSON，有人喜欢用DTO，有人喜欢直接Entity。</li></ol></blockquote><p>那如何解决这个问题呢？自动生成呗。一群喜欢动脑筋（懒）的人，发明了JHipster。<img src="/images/2018/02/logo-jhipster.svg" style="display:inline-block" width="65" height="65/"></p><blockquote><p><a href="http://www.jhipster.tech" target="_blank" rel="noopener">JHipster</a>是一个基于SpringBoot和Angular的快速Web应用和SpringCloud微服务的脚手架。本文将介绍如何利用JHipster快速开发Web应用。</p></blockquote><h2 id="安装JHipster"><a href="#安装JHipster" class="headerlink" title="安装JHipster"></a>安装JHipster</h2><p>JHipster支持好几种安装方式，这里选用最方便的一种方式：Yarn</p><h5 id="1-安装Java8；"><a href="#1-安装Java8；" class="headerlink" title="1. 安装Java8；"></a>1. 安装<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">Java8</a>；</h5><h5 id="2-安装Node-js"><a href="#2-安装Node-js" class="headerlink" title="2. 安装Node.js"></a>2. 安装<a href="http://nodejs.org/" target="_blank" rel="noopener">Node.js</a></h5><h5 id="3-安装Yarn"><a href="#3-安装Yarn" class="headerlink" title="3. 安装Yarn"></a>3. 安装<a href="https://yarnpkg.com/en/docs/install" target="_blank" rel="noopener">Yarn</a></h5><h5 id="4-安装JHipster：-yarn-global-add-generator-jhipster"><a href="#4-安装JHipster：-yarn-global-add-generator-jhipster" class="headerlink" title="4. 安装JHipster： yarn global add generator-jhipster"></a>4. 安装JHipster： <code>yarn global add generator-jhipster</code></h5><h2 id="创建Web应用"><a href="#创建Web应用" class="headerlink" title="创建Web应用"></a>创建Web应用</h2><h5 id="1-创建项目目录"><a href="#1-创建项目目录" class="headerlink" title="1. 创建项目目录"></a>1. 创建项目目录</h5><h5 id="2-为一些被墙的资源添加国内源"><a href="#2-为一些被墙的资源添加国内源" class="headerlink" title="2. 为一些被墙的资源添加国内源"></a>2. 为一些被墙的资源添加国内源</h5><p>在项目目录下创建<code>.npmrc</code>文件，为该项目特指一些源。（当然，你也可以为Node和Yarn指定全局的源，那就可以跳过这一步）<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sass_binary_site=https://npm.taobao.org/mirrors/node-sass/</span><br><span class="line">phantomjs_cdnurl=https://npm.taobao.org/mirrors/phantomjs/</span><br><span class="line">electron_mirror=https://npm.taobao.org/mirrors/electron/</span><br><span class="line">registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><p></p><h5 id="3-在项目目录下运行命令jhipster初始化"><a href="#3-在项目目录下运行命令jhipster初始化" class="headerlink" title="3. 在项目目录下运行命令jhipster初始化"></a>3. 在项目目录下运行命令<code>jhipster</code>初始化</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">  <span class="string">(1/16)</span> <span class="string">Which</span> <span class="string">*type*</span> <span class="string">of</span> <span class="string">application</span> <span class="string">would</span> <span class="string">you</span> <span class="string">like</span> <span class="string">to</span> <span class="string">create?</span> <span class="string">(Use</span> <span class="string">arrow</span> <span class="string">keys)</span></span><br><span class="line"><span class="string">&gt; Monolithic application (recommended for simple projects) </span></span><br><span class="line"><span class="string">  //传统Web应用</span></span><br><span class="line"><span class="string">  Microservice application</span></span><br><span class="line"><span class="string">  //微服务</span></span><br><span class="line"><span class="string">  Microservice gateway</span></span><br><span class="line"><span class="string">  //微服务网关</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (2/16) What is the base name of your application? (jhipster) jhipster_quick_start</span></span><br><span class="line"><span class="string">  //输入项目名称，对应Maven的 artifactId</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (3/16) What is your default Java package name? (com.chimestone) com.edi</span></span><br><span class="line"><span class="string">  //输入默认包名，对应Maven的 groupId</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (4/16) Do you want to use the JHipster Registry to configure, monitor and scale your application? (Use arrow keys)</span></span><br><span class="line"><span class="string">&gt; No</span></span><br><span class="line"><span class="string">  Yes</span></span><br><span class="line"><span class="string">  //选择是否启用JHipster Registry（微服务默认开启），它可以理解为Eureka、Spring Cloud Config Server、Spring Cloud Admin的一个合体</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (5/16) Which *type* of authentication would you like to use? (Use arrow keys)</span></span><br><span class="line"><span class="string">  JWT authentication (stateless, with a token)</span></span><br><span class="line"><span class="string">&gt; HTTP Session Authentication (stateful, default Spring Security mechanism)</span></span><br><span class="line"><span class="string">  OAuth2 Authentication (stateless, with an OAuth2 server implementation)</span></span><br><span class="line"><span class="string">  //选择认证方式，支持JWT、Session和OATUH2三种</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (6/16) Which *type* of database would you like to use? (Use arrow keys)</span></span><br><span class="line"><span class="string">&gt; SQL (H2, MySQL, MariaDB, PostgreSQL, Oracle, MSSQL)</span></span><br><span class="line"><span class="string">  MongoDB</span></span><br><span class="line"><span class="string">  Cassandra</span></span><br><span class="line"><span class="string">  //选择数据库类型</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (7/16) Which *production* database would you like to use? (Use arrow keys)</span></span><br><span class="line"><span class="string">&gt; MySQL</span></span><br><span class="line"><span class="string">  MariaDB</span></span><br><span class="line"><span class="string">  PostgreSQL</span></span><br><span class="line"><span class="string">  Oracle (Please follow our documentation to use the Oracle proprietary driver)</span></span><br><span class="line"><span class="string">  Microsoft SQL Server</span></span><br><span class="line"><span class="string">  //选择数据库</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (8/16) Which *development* database would you like to use?</span></span><br><span class="line"><span class="string">  H2 with disk-based persistence</span></span><br><span class="line"><span class="string">&gt; H2 with in-memory persistence</span></span><br><span class="line"><span class="string">  MySQL</span></span><br><span class="line"><span class="string">  //选择开发时连接的数据库，这里选H2只是为了演示</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (9/16) Do you want to use Hibernate 2nd level cache? (Use arrow keys)</span></span><br><span class="line"><span class="string">&gt; Yes, with ehcache (local cache, for a single node)</span></span><br><span class="line"><span class="string">  Yes, with HazelCast (distributed cache, for multiple nodes)</span></span><br><span class="line"><span class="string">  [BETA] Yes, with Infinispan (hybrid cache, for multiple nodes)</span></span><br><span class="line"><span class="string">  No</span></span><br><span class="line"><span class="string">  //选择集成到Hibernate2级缓存</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (10/16) Would you like to use Maven or Gradle for building the backend? (Use arrow keys)</span></span><br><span class="line"><span class="string">&gt; Maven</span></span><br><span class="line"><span class="string">  Gradle</span></span><br><span class="line"><span class="string">  //选择打包工具</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (11/16) Which other technologies would you like to use?</span></span><br><span class="line"><span class="string">  ( ) Social login (Google, Facebook, Twitter)</span></span><br><span class="line"><span class="string">  (*) Search engine using Elasticsearch</span></span><br><span class="line"><span class="string"> &gt;(*) WebSockets using Spring Websocket</span></span><br><span class="line"><span class="string">  ( ) API first development using swagger-codegen</span></span><br><span class="line"><span class="string">  ( ) [BETA] Asynchronous messages using Apache Kafka</span></span><br><span class="line"><span class="string">  //选择其他的集成框架，这里注意要按下空格键才是启用，启用后会加上*标识。看到无脑自动集成ES是不是泪流满面？</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (12/16) Which *Framework* would you like to use for the client? (Use arrow keys)</span></span><br><span class="line"><span class="string">&gt; Angular 4</span></span><br><span class="line"><span class="string">  AngularJS 1.x</span></span><br><span class="line"><span class="string">  //选择集成的Angular的版本，Angular4采用Webpack打包自动化，而1.x采用Bower和Gulp做自动化</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (13/16) Would you like to use the LibSass stylesheet preprocessor for your CSS? (y/N) y</span></span><br><span class="line"><span class="string">  //是否启用LibSass</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (14/16) Would you like to enable internationalization support? (Y/n) n</span></span><br><span class="line"><span class="string">  //是否开启国际化</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (15/16) Besides JUnit and Karma, which testing frameworks would you like to use? (Press &lt;space&gt; to select, &lt;a&gt; to toggle all, &lt;i&gt; to inverse selection)</span></span><br><span class="line"><span class="string"> &gt;( ) Gatling</span></span><br><span class="line"><span class="string">  ( ) Cucumber</span></span><br><span class="line"><span class="string">  ( ) Protractor</span></span><br><span class="line"><span class="string">  //选择测试框架，做压力测试的同学有福了</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  (16/16) Would you like to install other generators from the JHipster Marketplace? (y/N)</span></span><br><span class="line"><span class="string">  //从JHipster市场下载一些其他集成，上下键翻动，空格选取/反选，回车结束。可以看到市场里还是有不少好东西的，像pages服务、ReactNative集成、swagger2markup让你的swagger界面更漂亮、gRPC自动CRUD代码等。</span></span><br></pre></td></tr></table></figure><p>全部选择后，就开始了自动执行生成项目，喝杯水坐等。<strong>如果没有翻墙且忘了添加第二步的同学，请坐等卡住。</strong><br>这里有一点必须提醒，虽然JHipster选项中可以启用ES集成，<strong>但受SpringBoot对ES的集成版本限制</strong>。<br>JHipster采用的是1.5.X的SpringBoot版本，对应的spring-data-elasticsearch是2.1.X版本，该版本最高支持ES到2.X，醉了~~~具体参见<a href="https://github.com/spring-projects/spring-data-elasticsearch" target="_blank" rel="noopener">这里</a><br>所以如果要使用高版本的ES，还是得用ES自己提供的REST接口，据ES的一篇文章<a href="https://www.elastic.co/blog/benchmarking-rest-client-transport-client" target="_blank" rel="noopener">Benchmarking REST client and transport client</a>显示，5.0以后的ES自带的REST接口性能还是可以的。</p><h2 id="基本姿势"><a href="#基本姿势" class="headerlink" title="基本姿势"></a>基本姿势</h2><p>对于普通Web应用，JHipster在SpringBoot中默认加载了<code>SpringMVC</code>、<code>SpringData</code>、<code>SpringJPA</code>、<code>SpringSecurity</code>几个主要的Web相关的家族成员，LogStash作为日志工具，同时引入了<code>ApacheCommons</code>包、<code>Swagger</code>、<code>HikariCP</code>数据库连接池、<code>Jackson</code>等工具。基本上开发一个JavaWeb项目所需的框架都具备了，甚至还引入了<code>Metrics</code>做运维监控。<br>此外，它还引入两个特殊的组件——<code>Liquibase</code>和<code>MapperStruct</code>。</p><ul><li><a href="liquibase.org">Liquibase</a>是一个帮助管理数据库变更的工具</li><li><a href="http://mapstruct.org/" target="_blank" rel="noopener">MapperStruct</a>用于自动生成Entity和对应DTO之间的映射关系类，<strong>在使用DTO时，千万记得要把自动生成的目录加到IDE的项目路径里</strong>！</li></ul><p>国内搞JavaWeb的，大都喜欢使用<code>Mybatis</code>，可惜的是JHipster默认并不提供<code>Mybatis</code>的集成。但是<code>SpringJPA</code>现在已经封装的十分完善，常规的CRUD和分页，在JHipster下，无需写一行代码（是的，你没看错）。<br>如果确实需要比较复杂的级联查询，JPA也提供了Specification和Sample实现，性能测试下来其实没多大区别，对付普通Web足以。<br>如果确实不喜欢JPA，好在SpringBoot本身可以同时使用JPA和Mybatis，那么就把复杂级联用Mybatis，普通CRUD用JPA，达到最佳效果。</p><h5 id="代码结构"><a href="#代码结构" class="headerlink" title="代码结构"></a>代码结构</h5><ul><li><p><strong>Entity</strong><br>JHipster自动产生的项目，内置了<code>User</code>、<code>Authority</code>、<code>PersistentToken</code>、<code>PersistentAuditEvent</code>四个Entity（如果选取的还有其他组件，如OAUTH2等，会有对应的Entity自动生成）。产生的几张表均以<code>jhi_</code>开头。如果启用了ES，那么除了<code>@Entity</code>注解外，你还会看到<code>@Document</code>注解。<br>这里值得一提的是，官方并不推荐修改默认的表名，而且如果要更改User的字段，官方推荐使用创建一个子类继承User类，然后在该子类中把User给Map进来，参见<a href="http://www.jhipster.tech/tips/022_tip_registering_user_with_additional_information.html" target="_blank" rel="noopener">这里</a>。但其实完全自己修改，然后更新数据库字段后，用Liquibase diff命令生成changelog。</p></li><li><p><strong>Controller</strong><br>JHipster自动生成的Controller暴露出的RESTful接口都是<a href="http://www.ruanyifeng.com/blog/2014/05/restful_api.html" target="_blank" rel="noopener">标准的RESTful API风格</a>，国内很多程序员都不在乎这个东西，导致代码风格及其粗狂。</p></li><li><p><strong>Repository</strong><br>这一块得益于SpringJPA的强大，一个JpaRepository接口足以满足大多数需求，有些懒人甚至连Controller都懒得写，给Repository接口加上<code>@RepositoryRestResource</code>注解直接暴露RESTful接口出去。</p></li></ul><h5 id="开始表演"><a href="#开始表演" class="headerlink" title="开始表演"></a>开始表演</h5><p>熟悉了代码结构后，我们开始用JHipster来做项目了。</p><ol><li>创建JDL文件描述Entity<br>JHipster默认提供了以下几种类型及校验关键字：</li></ol><table><thead><tr><th>类型</th><th style="text-align:right">校验</th><th style="text-align:right">备注</th></tr></thead><tbody><tr><td>String</td><td style="text-align:right">required, minlength, maxlength, pattern</td><td style="text-align:right">Java String类型，默认长度取决于使用的底层技术，JPA默认是255长，可以用validation rules修改到1024</td></tr><tr><td>Integer</td><td style="text-align:right">required, min, max</td><td style="text-align:right"></td></tr><tr><td>Long</td><td style="text-align:right">required, min, max</td><td style="text-align:right"></td></tr><tr><td>BigDecimal</td><td style="text-align:right">required, min, max</td><td style="text-align:right"></td></tr><tr><td>Float</td><td style="text-align:right">required, min, max</td><td style="text-align:right"></td></tr><tr><td>Double</td><td style="text-align:right">required, min, max</td><td style="text-align:right"></td></tr><tr><td>Enum</td><td style="text-align:right">required</td><td style="text-align:right"></td></tr><tr><td>Boolean</td><td style="text-align:right">required</td><td style="text-align:right"></td></tr><tr><td>LocalDate</td><td style="text-align:right">required</td><td style="text-align:right">对应<code>java.time.LocalDate</code>类</td></tr><tr><td>Instant</td><td style="text-align:right">required</td><td style="text-align:right">对应<code>java.time.Instant</code>类，DB中映射为<code>Timestamp</code></td></tr><tr><td>ZonedDateTime</td><td style="text-align:right">required</td><td style="text-align:right">对应<code>java.time.ZonedDateTime</code>类，用于需要提供TimeZone的日期</td></tr><tr><td>Blob</td><td style="text-align:right">required, minbytes, maxbytes</td><td style="text-align:right"></td></tr></tbody></table><p>官方提供了一个在线的<a href="https://start.jhipster.tech/jdl-studio/" target="_blank" rel="noopener">JDL Studio</a>，方便撰写JDL。<br>例子如下：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//双斜杠注释会被忽略掉</span><br><span class="line">/** 这种注释会带到生成的代码里去 */</span><br><span class="line">entity Person &#123;</span><br><span class="line">    name String required,</span><br><span class="line">    sex Sex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">enum Sex &#123;</span><br><span class="line">    MALE, FEMALE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">entity Country&#123;</span><br><span class="line">    countryName String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">relationship ManyToOne &#123;</span><br><span class="line">    Person&#123;country&#125; to Country</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">paginate Person with pagination</span><br><span class="line">paginate Country with infinite-scroll</span><br></pre></td></tr></table></figure><ol><li>用<code>jhipster import-jdl your-jdl-file.jdl</code>导入Entity。<br>中间会提示有<code>conflict</code>，因为像Cache配置、LiquidBase配置等是已存在的，可以覆盖或merge。<br>执行完毕后，看到代码已经生成进去了。</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.edi.domain;</span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这种注释会带到生成的代码里去</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiModel</span>(description = <span class="string">"这种注释会带到生成的代码里去"</span>)</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"person"</span>)</span><br><span class="line"><span class="meta">@Cache</span>(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)</span><br><span class="line"><span class="meta">@Document</span>(indexName = <span class="string">"person"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>, nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Enumerated</span>(EnumType.STRING)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"sex"</span>)</span><br><span class="line">    <span class="keyword">private</span> Sex sex;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne</span></span><br><span class="line">    <span class="keyword">private</span> Country country;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jhipster-needle-entity-add-field - Jhipster will add fields here, do not remove</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">name</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Sex <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">sex</span><span class="params">(Sex sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(Sex sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Country <span class="title">getCountry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> country;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">country</span><span class="params">(Country country)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.country = country;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCountry</span><span class="params">(Country country)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.country = country;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// jhipster-needle-entity-add-getters-setters - Jhipster will add getters and setters here, do not remove</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>看到有段注释带进去了。<br>再看下Controller<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.edi.web.rest;</span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * REST controller for managing Person.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/api"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonResource</span> </span>&#123;</span><br><span class="line"> ... </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * GET  /people : get all the people.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageable the pagination information</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the ResponseEntity with status 200 (OK) and the list of people in body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/people"</span>)</span><br><span class="line">    <span class="meta">@Timed</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;List&lt;Person&gt;&gt; getAllPeople(<span class="meta">@ApiParam</span> Pageable pageable) &#123;</span><br><span class="line">        log.debug(<span class="string">"REST request to get a page of People"</span>);</span><br><span class="line">        Page&lt;Person&gt; page = personRepository.findAll(pageable);</span><br><span class="line">        HttpHeaders headers = PaginationUtil.generatePaginationHttpHeaders(page, <span class="string">"/api/people"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(page.getContent(), headers, HttpStatus.OK);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * SEARCH  /_search/people?query=:query : search for the person corresponding</span></span><br><span class="line"><span class="comment">     * to the query.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> query the query of the person search</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageable the pagination information</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the result of the search</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/_search/people"</span>)</span><br><span class="line">    <span class="meta">@Timed</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;List&lt;Person&gt;&gt; searchPeople(<span class="meta">@RequestParam</span> String query, <span class="meta">@ApiParam</span> Pageable pageable) &#123;</span><br><span class="line">        log.debug(<span class="string">"REST request to search for a page of People for query &#123;&#125;"</span>, query);</span><br><span class="line">        Page&lt;Person&gt; page = personSearchRepository.search(queryStringQuery(query), pageable);</span><br><span class="line">        HttpHeaders headers = PaginationUtil.generateSearchPaginationHttpHeaders(query, page, <span class="string">"/api/_search/people"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(page.getContent(), headers, HttpStatus.OK);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>其他的不一一列举了，这里着重看下上面两个实现，一个是分页返回列表，一个是ES搜索。<br>分页这里与我们常规有所不同，它是把分页信息通过<code>PaginationUtil.generatePaginationHttpHeaders(page, &quot;/api/people&quot;);</code>这里生成到<code>Header</code>里去了，前端需要从Header里取。</p><h5 id="自定义修改返回类型-Optional"><a href="#自定义修改返回类型-Optional" class="headerlink" title="自定义修改返回类型(Optional)"></a>自定义修改返回类型(Optional)</h5><p>好吧，看到上面肯定有同学要说了，我们平时分页都是返回JSON，所有数据都是返回JSON！<br>如果非得这么做，那就只能自己做个ResponseUtil，把结果包装成如下格式</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"data"</span>:&#123;</span><br><span class="line">        <span class="attr">"content"</span>: [&#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"张三"</span>,</span><br><span class="line">            <span class="attr">"country"</span>: <span class="string">"中国"</span>,</span><br><span class="line">            <span class="attr">"sex"</span>: <span class="string">"MALE"</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"code"</span>: <span class="number">200</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只需增加两个新类：<br><code>CommonResponse</code><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonResponse</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CODE = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> success;</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code=DEFAULT_CODE;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonResponse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonResponse</span><span class="params">(<span class="keyword">boolean</span> success, T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.success = success;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonResponse</span><span class="params">(<span class="keyword">boolean</span> success, T data, <span class="keyword">int</span> code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.success = success;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ... <span class="comment">//get &amp; set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><code>ResponseUtil</code><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(ResponseUtil.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ResponseUtil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResponseEntity&lt;CommonResponse&gt; <span class="title">okResponse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, <span class="keyword">null</span>, DEFAULT_CODE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(<span class="keyword">int</span> statusCode)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, <span class="keyword">null</span>, statusCode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(T data)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, data, DEFAULT_CODE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(T data, Pageable pageable)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, data, DEFAULT_CODE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(T data, <span class="keyword">int</span> statusCode)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, data, statusCode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(<span class="keyword">boolean</span> successful,T data)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, data, DEFAULT_CODE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(<span class="keyword">boolean</span> successful, <span class="keyword">int</span> statusCode)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, <span class="keyword">null</span>, statusCode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(<span class="keyword">boolean</span> successful, T data, <span class="keyword">int</span> statusCode)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok(<span class="keyword">new</span> CommonResponse&lt;&gt;(successful, data, statusCode));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapResponse</span><span class="params">(<span class="keyword">boolean</span> successful,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                                  Optional&lt;T&gt; maybeResponse,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                                  HttpHeaders headers,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                                  <span class="keyword">int</span> statusCode)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (ResponseEntity)maybeResponse.map((response) -&gt; &#123;</span><br><span class="line">            CommonResponse&lt;T&gt; commonResponse = <span class="keyword">new</span> CommonResponse&lt;&gt;(successful, response, statusCode);</span><br><span class="line">            <span class="keyword">return</span> ((ResponseEntity.BodyBuilder)ResponseEntity.ok().headers(headers)).body(commonResponse);</span><br><span class="line">        &#125;).orElse(<span class="keyword">new</span> ResponseEntity(<span class="keyword">new</span> CommonResponse&lt;&gt;(successful, <span class="keyword">null</span>, HttpStatus.NOT_FOUND.value()), HttpStatus.NOT_FOUND));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">ResponseEntity&lt;CommonResponse&gt; <span class="title">wrapOrNotFound</span><span class="params">(Optional&lt;T&gt; maybeResponse)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wrapResponse(<span class="keyword">true</span>, maybeResponse, <span class="keyword">null</span>, DEFAULT_CODE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>然后修改下Controller里面的返回为如下即可<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/people"</span>)</span><br><span class="line"><span class="meta">@Timed</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;List&lt;Person&gt;&gt; getAllPeople(<span class="meta">@ApiParam</span> Pageable pageable) &#123;</span><br><span class="line">    log.debug(<span class="string">"REST request to get a page of People"</span>);</span><br><span class="line">    Page&lt;Person&gt; page = personRepository.findAll(pageable);</span><br><span class="line">    <span class="comment">//HttpHeaders headers = PaginationUtil.generatePaginationHttpHeaders(page, "/api/people");</span></span><br><span class="line">    <span class="comment">//return new ResponseEntity&lt;&gt;(page.getContent(), headers, HttpStatus.OK);</span></span><br><span class="line">    <span class="keyword">return</span> ResponseUtil.wrapResponse(page);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h5 id="打包运行"><a href="#打包运行" class="headerlink" title="打包运行"></a>打包运行</h5><p>先执行<code>yarn install &amp;&amp; bower install</code> (Angular 1.x版本) 或 <code>yarn install</code>(Angular 4版本)对前端代码进行编译。<br>然后可选：</p><ul><li>命令行运行 ./mvnw</li><li>带LiveReload前端调试 gulp (Angular1.x版本)或yarn start(Angular 4版本)</li><li>生产编译 ./mvnw clean package -Pprod</li></ul><p>启动后，默认在本地8080端口启动JHipster的页面，看到已经用它自己的模板实现了常规页面。我们需要做的只是自己做套Angluar页面，套用该模板下的请求处理就好了。</p><h2 id="高级姿势"><a href="#高级姿势" class="headerlink" title="高级姿势"></a>高级姿势</h2><h5 id="Docker集成"><a href="#Docker集成" class="headerlink" title="Docker集成"></a>Docker集成</h5><p>在/src/main/docker/目录下，JHipster提供了docker化所需的所有文件，所以开箱即用。例如，</p><ul><li>启动一个mysql数据库： <code>docker-compose -f src/main/docker/mysql.yml up -d</code></li><li>停止并删除该mysql数据库： <code>docker-compose -f src/main/docker/mysql.yml down</code></li><li>Maven将本项目打包成docker镜像： <code>./mvnw package -Pprod dockerfile:build</code></li><li>启动项目容器： <code>docker-compose -f src/main/docker/app.yml up -d</code></li></ul><p>如果需要maven打包docker镜像后推到Registry，则需要修改pom.xml，将<code>dockerfile-maven-plugin</code>中注释掉的一段给打开。</p><h5 id="CI集成"><a href="#CI集成" class="headerlink" title="CI集成"></a>CI集成</h5><p>(留坑)</p><h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>正常情况下，用<code>Jhipster</code>快速实现普通的JavaWeb项目其实仅需三步：1.初始化项目；2.用JDL创建自己的Entity；3.导入JDL；<br>作为一个脚手架，使用起来已经非常方便了，而且它还支持微服务项目。<br>既然谈到脚手架，不由自主的会与JFinal等其他脚手架对比，JHipster不一定比其他脚手架轻快，但好在代码规范，Spring家族全套，回头看看，确实可以解决文初的那两个问题。</p><div class="article-copyright"><i class="fa fa-lightbulb-o"></i> 本文由 <a href="http://edisonxu.org/2018/02/01/jhipster-quick-start.html">EdisonXu - 徐焱飞</a> 创作，采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 进行许可。 可自由转载、引用，但需署名作者且注明文章出处。本位链接为<a href="http://edisonxu.org/2018/02/01/jhipster-quick-start.html" target="_blank" rel="external">http://edisonxu.org/2018/02/01/jhipster-quick-start.html</a></div><div class="article-dashang"> <span>如果您觉得文章不错,可以请我喝一杯咖啡！</span><br><a id="btn_donate" class="btn_donate" target="_self" href="javascript:;" title="Donate 打赏"></a><div id="dim-codes" hidden="hidden"><ul class="img_box_ul"><li><img src="/css/images/weixin.png"></li><li><img src="/css/images/zhifubao.png"></li></ul></div></div><script type="text/javascript">$("#btn_donate").click(function(){$("#dim-codes").toggle(300)})</script></div><footer class="article-footer"><div class="share-container"><div class="bdsharebuttonbox"> <a href="#" class="bds_more" data-cmd="more">分享到：</a> <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a> <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a> <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a> <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a> <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a></div><script>with(window._bd_share_config={common:{bdSnsKey:{},bdText:"",bdMini:"2",bdMiniList:!1,bdPic:"",bdStyle:"0",bdSize:"16"},share:{bdSize:16}},document)(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)</script><style>.bdshare_popup_box{border-radius:4px;border:#e1e1e1 solid 1px}.bdshare-button-style0-16 .bds_more,.bdshare-button-style0-16 a{padding-left:20px;margin:6px 10px 6px 0}.bdshare_dialog_list a,.bdshare_popup_bottom a,.bdshare_popup_list a{font-family:'Microsoft Yahei'}.bdshare_popup_top{display:none}.bdshare_popup_bottom{height:auto;padding:5px}</style></div></footer></div><nav id="article-nav"> <a href="/2018/10/30/akka-intro.html" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">上一篇</strong><div class="article-nav-title"> Akka入门系列(一)：基本介绍</div></a> <a href="/2017/04/24/axon-spring-cloud.html" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">下一篇</strong><div class="article-nav-title">Axon入门系列(八)：AxonFramework与SpringCloud的整合</div></a></nav></article><section id="comments"><div id="gitalk-container"></div></section></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">公告</h3><div class="widget"><div class="card-front animated col s12 m12 l8 offset-l2 fadeInUp"><p class="board"> 您好，您是第<span id="busuanzi_value_site_uv"></span>位访客<br> QQ：228831793<br> 微信：fei158383<br> 邮箱：edisonxu@outlook.com<br> CQRS&ES交流群：57241527<br><br> 欢迎交流与分享经验!</p></div></div></div><div class="widget-wrap"><h3 class="widget-title">归档</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">2</span></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">标签云</h3><div class="widget tagcloud"> <a href="/tags/CQRS/" style="font-size:20px">CQRS</a> <a href="/tags/DDD/" style="font-size:20px">DDD</a> <a href="/tags/JHipster/" style="font-size:10px">JHipster</a> <a href="/tags/SpringBoot/" style="font-size:10px">SpringBoot</a> <a href="/tags/actor/" style="font-size:12.5px">actor</a> <a href="/tags/akka/" style="font-size:15px">akka</a> <a href="/tags/axon/" style="font-size:20px">axon</a> <a href="/tags/event-sourcing/" style="font-size:10px">event sourcing</a> <a href="/tags/eventsourcing/" style="font-size:17.5px">eventsourcing</a> <a href="/tags/eventuate/" style="font-size:10px">eventuate</a> <a href="/tags/多线程/" style="font-size:10px">多线程</a> <a href="/tags/并发/" style="font-size:12.5px">并发</a> <a href="/tags/并行/" style="font-size:10px">并行</a> <a href="/tags/微服务/" style="font-size:10px">微服务</a> <a href="/tags/感悟/" style="font-size:10px">感悟</a> <a href="/tags/杂项/" style="font-size:10px">杂项</a></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">链接</h3><div class="widget"><ul><li> <a href="http://bbs.springcloud.cn">SpringCloud中文社区</a></li><li> <a href="http://www.spring4all.com">Spring For All社区</a></li><li> <a href="http://itmuch.com">周立|Spring Cloud</a></li><li> <a href="http://blog.didispace.com">程序猿DD</a></li><li> <a href="http://www.cnblogs.com/netfocus">汤雪华的博客</a></li><li> <a href="http://edisonxu.com">EdisonXu</a></li></ul></div></div><div id="toTop" class="fa fa-angle-up"></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner"> &copy; 2018 Edison Xu<br> 本站总访问量<span id="busuanzi_value_site_pv"></span>次<br> <a href="http://www.miitbeian.gov.cn/publish/query/indexFirst.action" target="_blank">沪ICP备18006173号</a></div></div></footer><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var gitalk=new Gitalk({clientID:"268be44c555ad2a36b32",clientSecret:"9cf79c6df51e0753755f03afea7be813f3371d91",repo:"EdisonXu.github.io.git",owner:"xeseo2005@gmail.com",admin:["xeseo2005@gmail.com"],id:md5(window.location.pathname),distractionFreeMode:!1});gitalk.render("gitalk-container")</script> %><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/vendor/lightgallery/js/lightgallery.min.js"></script><script src="/vendor/lightgallery/js/lg-thumbnail.min.js"></script><script src="/vendor/lightgallery/js/lg-pager.min.js"></script><script src="/vendor/lightgallery/js/lg-autoplay.min.js"></script><script src="/vendor/lightgallery/js/lg-fullscreen.min.js"></script><script src="/vendor/lightgallery/js/lg-zoom.min.js"></script><script src="/vendor/lightgallery/js/lg-hash.min.js"></script><script src="/vendor/lightgallery/js/lg-share.min.js"></script><script src="/vendor/lightgallery/js/lg-video.min.js"></script><script src="/js/main.js"></script></div></body></html>